<!DOCTYPE html>
<html lang="en">
<head>
<link rel="manifest" href="manifest.json">
<meta charset="UTF-8">
<title>Vibe with Jishnu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0f2e">Â 

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDohsquOam8YQXz7tqrWOG5f4pcXh-CnBM",
        authDomain: "weapon-fanpage.firebaseapp.com",
        projectId: "weapon-fanpage",
        storageBucket: "weapon-fanpage.firebasestorage.app",
        messagingSenderId: "124549409527",
        appId: "1:124549409527:web:85657a1d41c8950f7601f2",
        measurementId: "G-MXBR3C8ET7"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    window.db = db; // Make DB available globally for use in the main script
</script>


<style>
/* PAGE THEME */
body {
Â  Â  margin: 0;
Â  Â  background: #0a0f2e;
Â  Â  color: white;
Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  overflow-x: hidden;
Â  Â  position: relative;
Â  Â  min-height: 100vh;
}

/* --- THE BEATING HEART BACKGROUND --- */
#bass-bg {
Â  Â  position: fixed;
Â  Â  top: 50%;
Â  Â  left: 50%;
Â  Â  width: 80vw;
Â  Â  height: 80vw;
Â  Â  max-height: 80vh;
Â  Â  max-width: 80vh;
Â  Â  transform: translate(-50%, -50%);
Â  Â  background: radial-gradient(circle, var(--song-color, #6a5bff) 0%, rgba(0,0,0,0) 70%);
Â  Â  opacity: 0;
Â  Â  z-index: -1;
Â  Â  pointer-events: none;
Â  Â  border-radius: 50%;
Â  Â  transition: background 0.5s ease;
}

/* Pulse Animation */
.pulsing #bass-bg {
Â  Â  animation: heartbeat 0.6s cubic-bezier(0.1, 0.7, 1.0, 0.1) infinite;
}

@keyframes heartbeat {
Â  Â  0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.1; }
Â  Â  10% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.6; }
Â  Â  100% { transform: translate(-50%, -50%) scale(1.6); opacity: 0; }
}

/* HEADER */
header {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 15px;
Â  Â  padding: 20px;
Â  Â  background: rgba(30, 0, 70, 0.8);
Â  Â  backdrop-filter: blur(8px);
Â  Â  border-bottom: 2px solid #6a5bff;
Â  Â  position: sticky;
Â  Â  top: 0;
Â  Â  z-index: 10;
}
header img { height: 50px; }
header h1 {
Â  Â  font-size: 28px;
Â  Â  font-weight: 800;
Â  Â  background: linear-gradient(90deg, #6a5bff, #b84bff);
Â  Â  -webkit-background-clip: text;
Â  Â  -webkit-text-fill-color: transparent;
Â  Â  margin: 0;
Â  Â  letter-spacing: 1px;
}

/* CONTENT PADDING - Increased to prevent player overlap */
.content { padding-bottom: 180px; }

/* PLAYLIST BOX */
.playlistContainer {
Â  Â  width: 90%;
Â  Â  max-width: 700px;
Â  Â  margin: 20px auto;
Â  Â  background: rgba(255,255,255,0.03);
Â  Â  border-radius: 12px;
Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  padding: 15px;
Â  Â  transition: all 0.3s ease;
Â  Â  cursor: pointer;
}
.playlistContainer:hover {
Â  Â  background: rgba(255,255,255,0.07);
Â  Â  border-color: #6a5bff;
}

.playlistHeader { display: flex; align-items: center; gap: 15px; }
.playlistHeader img {
Â  Â  width: 70px; height: 70px; object-fit: cover;
Â  Â  border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.playlistTitle { font-size: 20px; font-weight: bold; }

/* SONG LIST */
.songList { display: none; margin-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px; }
.track {
Â  Â  display: flex; justify-content: space-between; align-items: center;
Â  Â  padding: 12px; border-radius: 6px; margin-bottom: 5px;
Â  Â  cursor: pointer; transition: background 0.2s;
}
.track:hover { background: rgba(255,255,255,0.1); }
.track strong { font-size: 14px; }
.track span { font-size: 12px; opacity: 0.7; }

/* PLAYER BAR - Adjusted bottom padding */
.player {
Â  Â  position: fixed;
Â  Â  bottom: 0; left: 0; width: 100%;
Â  Â  background: rgba(10, 5, 30, 0.95);
Â  Â  backdrop-filter: blur(10px);
Â  Â  padding: 15px 0 30px 0; /* Increased bottom padding */
Â  Â  display: flex; flex-direction: column;
Â  Â  justify-content: center; align-items: center;
Â  Â  border-top: 2px solid #6a5bff;
Â  Â  transition: border-color 0.5s ease;
Â  Â  z-index: 100;
Â  Â  box-shadow: 0 -10px 30px rgba(0,0,0,0.5);
}

.controls-row {
Â  Â  display: flex; justify-content: center; align-items: center; gap: 30px;
Â  Â  margin-bottom: 10px;
}

button.control {
Â  Â  width: 55px; height: 55px; border-radius: 50%; border: none;
Â  Â  background: linear-gradient(135deg, #6a5bff, #b84bff);
Â  Â  color: white; font-size: 20px; cursor: pointer;
Â  Â  transition: transform 0.2s, box-shadow 0.2s;
Â  Â  display: flex; justify-content: center; align-items: center;
Â  Â  box-shadow: 0 4px 15px rgba(106, 91, 255, 0.4);
}
button.control:active { transform: scale(0.95); }
button.control:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(106, 91, 255, 0.6); }

/* SEEK BAR / SLIDER */
.seek-container {
Â  Â  width: 80%;
Â  Â  max-width: 600px;
Â  Â  display: none;
Â  Â  align-items: center;
Â  Â  gap: 10px;
Â  Â  font-size: 12px;
Â  Â  color: rgba(255,255,255,0.7);
Â  Â  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

input[type="range"] {
Â  Â  -webkit-appearance: none;
Â  Â  width: 100%; height: 4px;
Â  Â  background: rgba(255,255,255,0.2);
Â  Â  border-radius: 2px; outline: none; cursor: pointer;
}
input[type="range"]::-webkit-slider-thumb {
Â  Â  -webkit-appearance: none; width: 14px; height: 14px;
Â  Â  background: var(--song-color, #6a5bff);
Â  Â  border-radius: 50%; cursor: pointer;
Â  Â  box-shadow: 0 0 10px var(--song-color, #6a5bff);
Â  Â  transition: transform 0.1s;
}
input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.3); }

/* POPUP - Adjusted bottom position */
#popup {
Â  Â  position: fixed; bottom: 160px; right: 20px; width: 220px; /* Adjusted from 130px */
Â  Â  background: rgba(15, 10, 40, 0.9);
Â  Â  padding: 15px; border-radius: 12px;
Â  Â  border: 1px solid rgba(255,255,255,0.1);
Â  Â  display: none; z-index: 90;
Â  Â  backdrop-filter: blur(10px);
Â  Â  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
Â  Â  animation: slideUp 0.3s ease-out;
}
@keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
#popup img { width: 100%; border-radius: 8px; margin-bottom: 10px; }

/* CLOSE BUTTON STYLE */
#closePopupBtn {
Â  Â  position: absolute;
Â  Â  top: 5px;
Â  Â  right: 8px;
Â  Â  background: none;
Â  Â  border: none;
Â  Â  color: rgba(255, 255, 255, 0.6);
Â  Â  font-size: 22px;
Â  Â  font-weight: bold;
Â  Â  cursor: pointer;
Â  Â  z-index: 100;
Â  Â  padding: 0;
Â  Â  line-height: 1;
Â  Â  transition: color 0.2s;
}
#closePopupBtn:hover {
Â  Â  color: #ff4d6d;
}

/* SCROLLING TITLE */
#popupSongName {
Â  Â  white-space: nowrap; overflow: hidden; width: 100%;
Â  Â  font-size: 14px; text-align: center; margin-bottom: 10px;
Â  Â  color: #fff; font-weight: 600;
}
#popupSongName span { display: inline-block; padding-left: 100%; animation: scrollText 8s linear infinite; }
@keyframes scrollText { 0% { transform: translateX(0%); } 100% { transform: translateX(-100%); } }

/* SOUNDWAVE */
.soundwave { display: flex; justify-content: center; gap: 4px; height: 15px; align-items: flex-end; }
.soundwave div { width: 3px; background: #6a5bff; animation: wave 0.8s infinite ease-in-out; }
.soundwave div:nth-child(2) { animation-delay: 0.1s; }
.soundwave div:nth-child(3) { animation-delay: 0.2s; }
.soundwave div:nth-child(4) { animation-delay: 0.3s; }
.soundwave div:nth-child(5) { animation-delay: 0.4s; }
@keyframes wave { 0%, 100% { height: 3px; } 50% { height: 15px; } }
.paused div { animation-play-state: paused; height: 3px; }

/* TRENDING SECTION */
.trendingContainer {
Â  Â  width: 90%;
Â  Â  max-width: 700px;
Â  Â  margin: 40px auto 20px auto;
}
.trendingContainer h2 {
Â  Â  font-size: 24px;
Â  Â  border-left: 5px solid #b84bff;
Â  Â  padding-left: 10px;
Â  Â  margin-bottom: 20px;
}
.trendingItem {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  padding: 15px 0;
Â  Â  border-bottom: 1px solid rgba(255,255,255,0.08);
Â  Â  cursor: pointer;
}
.trendingItem:last-child { border-bottom: none; }
.trendingRank {
Â  Â  font-size: 30px;
Â  Â  font-weight: bold;
Â  Â  color: #b84bff;
Â  Â  width: 40px;
Â  Â  text-align: center;
}
.trendingInfo { flex-grow: 1; margin-left: 15px; }
.trendingInfo strong { display: block; font-size: 16px; }
.trendingInfo span { font-size: 12px; opacity: 0.6; }
.trendingImg {
Â  Â  width: 50px;
Â  Â  height: 50px;
Â  Â  object-fit: cover;
Â  Â  border-radius: 6px;
Â  Â  margin-right: 15px;
}

</style>
</head>
<body class="">
Â  Â Â 
<div id="bass-bg"></div>

<header>
Â  Â  <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
Â  Â  <h1>Vibe with Jishnu</h1>
</header>

<div class="content">

Â  Â  Â  Â  <div class="trendingContainer">
Â  Â  Â  Â  <h2>ğŸ”¥ Trending Songs</h2>
Â  Â  Â  Â  <div id="trendingList">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingItem">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingRank">1</div>
Â  Â  Â  Â  Â  Â  Â  Â  <img class="trendingImg" src="Poster2.jpeg" alt="Album Cover">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingInfo">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Jishnu Anthem</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>G.R.Adhavh â€¢ 1,200 views</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="trendingItem">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingRank">2</div>
Â  Â  Â  Â  Â  Â  Â  Â  <img class="trendingImg" src="Poster.jpg" alt="Album Cover">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingInfo">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Flute anthem(LOT-III)</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>G.R.Adhavh â€¢ 980 views</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="trendingItem">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingRank">3</div>
Â  Â  Â  Â  Â  Â  Â  Â  <img class="trendingImg" src="poster4.png" alt="Album Cover">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="trendingInfo">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Bomb (Endhu 1cm)</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Kavinraaj, Kaliyappan, G.R.Adhavh â€¢ 750 views</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="playlistContainer">
Â  Â  Â  Â  <div class="playlistHeader" onclick="toggleList('list1')">
Â  Â  Â  Â  Â  Â  <img src="Poster.jpg" alt="LOT-III" onerror="this.src='https://via.placeholder.com/80/6a5bff/fff?text=Music'">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="playlistTitle">LOT-III OST</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; opacity:0.6">Original Sound Track</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="list1" class="songList"></div>
Â  Â  </div>
Â  Â Â 
Â  Â  <div class="playlistContainer">
Â  Â  Â  Â  <div class="playlistHeader" onclick="toggleList('list4')">
Â  Â  Â  Â  Â  Â  <img src="Poster.jpg" alt="LOT-III Singles" onerror="this.src='https://via.placeholder.com/80/6a5bff/fff?text=Music'">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="playlistTitle">LOT-III Singles</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; opacity:0.6">Latest Releases</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="list4" class="songList"></div>
Â  Â  </div>

Â  Â  <div class="playlistContainer">
Â  Â  Â  Â  <div class="playlistHeader" onclick="toggleList('list2')">
Â  Â  Â  Â  Â  Â  <img src="Poster2.jpeg" alt="50 Shades" onerror="this.src='https://via.placeholder.com/80/6a5bff/fff?text=Music'">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="playlistTitle">50 Shades of Jishnu Anthem</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; opacity:0.6">Song of the century</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="list2" class="songList"></div>
Â  Â  </div>

Â  Â  <div class="playlistContainer">
Â  Â  Â  Â  <div class="playlistHeader" onclick="toggleList('list3')">
Â  Â  Â  Â  Â  Â  <img src="Poster3.jpeg" alt="Hits" onerror="this.src='https://via.placeholder.com/80/6a5bff/fff?text=Music'">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="playlistTitle">Blockbuster Hits</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; opacity:0.6">Fan Favorites</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="list3" class="songList"></div>
Â  Â  </div>
</div>

<div id="popup">
Â  Â  <button id="closePopupBtn" onclick="closePopup()">Ã—</button>
Â  Â Â 
Â  Â  <img id="popupImg" src="" onerror="this.style.display='none'">
Â  Â  <div id="popupSongName"></div>
Â  Â  <div class="soundwave" id="soundwave">
Â  Â  Â  Â  <div></div><div></div><div></div><div></div><div></div>
Â  Â  </div>
</div>

<div class="player">
Â  Â  <div class="controls-row">
Â  Â  Â  Â  <button class="control" onclick="prevSong()">â®</button>
Â  Â  Â  Â  <button class="control" onclick="togglePlay()">
Â  Â  Â  Â  Â  Â  <span id="playPauseIcon" style="margin-left:2px;">â–¶</span>
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button class="control" onclick="nextSong()">â­</button>
Â  Â  </div>
Â  Â Â 
Â  Â  <div class="seek-container" id="seekContainer">
Â  Â  Â  Â  <span id="currTimeText">0:00</span>
Â  Â  Â  Â  <input type="range" id="seekSlider" min="0" max="100" value="0">
Â  Â  Â  Â  <span id="durTimeText">0:00</span>
Â  Â  </div>
</div>

<audio id="audio"></audio>

<script>
/* DATA */
const artists = {
Â  Â  // LOT-III
Â  Â  "Intermission(LOT-III)": "Jishnu, G.R.Adhavh",
Â  Â  "Saavachuruven unna(LOT-III)": "Jishnu, G.R.Adhavh, Sanjai",
Â  Â  "Sivagasi's Daaha(LOT-III)": "G.R.Adhavh, Shreyas",
Â  Â  "The namechange(LOT-III)": "Kavinraaj, G.R.Adhavh",
Â  Â  "Flute anthem(LOT-III)": "G.R.Adhavh",
Â  Â Â 
Â  Â  // LOT-III SINGLES
Â  Â  "Item number 1(LOT-III)": "G.R.Adhavh",
Â  Â  "Saavadi Saravedi(LOT-III)": "Kavinraaj, G.R.Adhavh",
Â  Â Â 
Â  Â  // 50 SHADES - UPDATED NAME
Â  Â  "Jishnu Anthem": "G.R.Adhavh",
Â  Â  "Jishnu Anthem Thalapathy Vijay Vocal": "G.R.Adhavh", // <--- UPDATED
Â  Â  "Jishnu Anthem slowed and reverbed": "G.R.Adhavh",
Â  Â  "Jishnu Anthem Karoke": "G.R.Adhavh",
Â  Â Â 
Â  Â  // HITS & NEW SONGS
Â  Â  "Harishankar ku irukka?": "Kavinraaj, G.R.Adhavh",
Â  Â  "Happy Birthday Megharajan": "G.R.Adhavh",
Â  Â Â 
Â  Â  // UPDATED: Use Display Names as keys
Â  Â  "Bomb (Endhu 1cm)": "Kavinraaj, Kaliyappan, G.R.Adhavh",
Â  Â  "Sanjai's room (Endhu 1cm)": "Shreyas, G.R.Adhavh",
Â  Â Â 
Â  Â  "default": "G.R.Adhavh"
};

const songAnimations = {
Â  Â  // LOT-III Colors
Â  Â  "Intermission(LOT-III)": "#ff4d6d",
Â  Â  "Saavachuruven unna(LOT-III)": "#4dd6ff",
Â  Â  "Sivagasi's Daaha(LOT-III)": "#ffa600",
Â  Â  "The namechange(LOT-III)": "#bb6bff",
Â  Â  "Flute anthem(LOT-III)": "#00ffbf",

Â  Â  // LOT-III Singles Colors
Â  Â  "Item number 1(LOT-III)": "#ffd700",
Â  Â  "Saavadi Saravedi(LOT-III)": "#ff4500",
Â  Â Â 
Â  Â  // 50 Shades Colors - UPDATED NAME
Â  Â  "Jishnu Anthem": "#00ff88",
Â  Â  "Jishnu Anthem Thalapathy Vijay Vocal": "#ccff00", // <--- UPDATED
Â  Â  "Jishnu Anthem slowed and reverbed": "#00ccff",
Â  Â  "Jishnu Anthem Karoke": "#ffffff",
Â  Â Â 
Â  Â  // Hits & New Colors
Â  Â  "Harishankar ku irukka": "#ff0055",
Â  Â  "Harishankar ku irukka?": "#ff0055",
Â  Â  "Happy Birthday Megharajan": "#a600ff",
Â  Â Â 
Â  Â  // UPDATED: Use Display Names as keys
Â  Â  "Bomb (Endhu 1cm)": "#ff3300",
Â  Â  "Sanjai's room (Endhu 1cm)": "#ff00cc",

Â  Â  "default": "#6a5bff"
};

const playlists = {
Â  Â  // RESTORED LOT-III
Â  Â  list1: [
Â  Â  Â  Â  "Anugundu Abhishek(LOT-III).mp3",
Â  Â  Â  Â  "DSK on the move(LOT-III).mp3",
Â  Â  Â  Â  "Hyper Harishankar(LOT-III).mp3",
Â  Â  Â  Â  "Intermission(LOT-III).mp3",
Â  Â  Â  Â  "Jishnu Anthem Reprise(LOT-III).mp3",
Â  Â  Â  Â  "The fight(LOT-III).mp3",
Â  Â  Â  Â  "King in the universe(LOT-III).mp3",
Â  Â  Â  Â  "King vs Harold(LOT-III).mp3",
Â  Â  Â  Â  "LOT-III teaser concert(LOT-III).mp3",
Â  Â  Â  Â  "LOT-III Theme(LOT-III).mp3",
Â  Â  Â  Â  "Saavachuruven unna(LOT-III).mp3",
Â  Â  Â  Â  "Sivagasi's Daaha(LOT-III).mp3",
Â  Â  Â  Â  "The namechange(LOT-III).mp3",
Â  Â  Â  Â  "Vadakku Sadhuram il Jishnu(LOT-III).mp3",
Â  Â  Â  Â  "Flute anthem.mp3"
Â  Â  ],
Â  Â  // NEW SINGLES PLAYLIST
Â  Â  list4: [
Â  Â  Â  Â  "Item number 1(LOT-III).mp3",
Â  Â  Â  Â  "Saavadi Saravedi(LOT-III).mp3"
Â  Â  ],
Â  Â  list2: [
Â  Â  Â  Â  "Jishnu Anthem.mp3",
Â  Â  Â  Â  "Jishnu anthem Thalapathy Vijay vocal.mp3", // <--- UPDATED FILE NAME
Â  Â  Â  Â  "Jishnu Anthem slowed and reverbed.mp3",
Â  Â  Â  Â  "Jishnu Anthem Karoke.mp3"
Â  Â  ],
Â  Â  list3: [
Â  Â  Â  Â  "Harishankar ku irukka.mp3",Â 
Â  Â  Â  Â  "Happy Birthday Megharajan.mp3",
Â  Â  Â  Â  "Bomb.mp3",Â 
Â  Â  Â  Â  "Sanjai.mp3"Â 
Â  Â  ]
};

/* UTILS */
function getArtist(song) { return artists[song.replace(".mp3","")] || artists["default"]; }
function getColor(song) { return songAnimations[song.replace(".mp3","")] || songAnimations["default"]; }

function getPopupImg(list, songName) {
Â  Â  if(list === "list1" || list === "list4") {
Â  Â  Â  Â  return "Poster.jpg";
Â  Â  }
Â  Â  else if(list === "list2") {
Â  Â  Â  Â  return "Poster2.jpeg";
Â  Â  }
Â  Â  else if(list === "list3") {
Â  Â  Â  Â  if(songName.includes("Bomb") || songName.includes("Sanjai")) {
Â  Â  Â  Â  Â  Â  return "poster4.png";
Â  Â  Â  Â  }
Â  Â  Â  Â  else if (songName.includes("Harishankar")) {
Â  Â  Â  Â  Â  Â  return "Poster3.jpeg";
Â  Â  Â  Â  }
Â  Â  Â  Â  else if (songName.includes("Happy Birthday")) {
Â  Â  Â  Â  Â  Â  return "poster3.png";
Â  Â  Â  Â  }
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  return "Poster3.jpeg";
Â  Â  Â  Â  }
Â  Â  }
Â  Â  return "Poster.jpg";
}

/* UI GENERATION */
for(let id in playlists){
Â  Â  if(id === 'list1') playlists[id].sort();
Â  Â Â 
Â  Â  let listElem = document.getElementById(id);

Â  Â  playlists[id].forEach((song, idx)=>{
Â  Â  Â  Â  let clean = song.replace(".mp3","");
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- DISPLAY NAME LOGIC ---
Â  Â  Â  Â  let displayName = clean;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(clean === "Harishankar ku irukka") displayName = "Harishankar ku irukka?";
Â  Â  Â  Â  if(clean === "Bomb") displayName = "Bomb (Endhu 1cm)";
Â  Â  Â  Â  if(clean === "Sanjai") displayName = "Sanjai's room (Endhu 1cm)";
Â  Â  Â  Â  // FIX: Display as LOT-III version but file is just "Flute anthem"
Â  Â  Â  Â  if(clean === "Flute anthem") displayName = "Flute anthem(LOT-III)";
Â  Â  Â  Â  // ADDED: Display name for the new file
        if(clean === "Jishnu anthem Thalapathy Vijay vocal") displayName = "Jishnu Anthem Thalapathy Vijay Vocal";
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Use displayName to lookup Artist
Â  Â  Â  Â  let artist = getArtist(displayName) || getArtist(clean);

Â  Â  Â  Â  let div = document.createElement("div");
Â  Â  Â  Â  div.className="track";
Â  Â  Â  Â  div.innerHTML = `<div><strong>${displayName}</strong><br><span>${artist}</span></div><span style="font-size:10px;">â–¶</span>`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- CLICK HANDLER ---
Â  Â  Â  Â  div.onclick = (e) => {Â 
Â  Â  Â  Â  Â  Â  e.stopPropagation();Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // LOGIC FOR PLAYLIST BEHAVIOR
Â  Â  Â  Â  Â  Â  if (id === 'list4') {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Dropping soon! ğŸš€");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  else if (id === 'list1') {
Â  Â  Â  Â  Â  Â  Â  Â  // LOT-III OST -> Check for Flute Anthem by display name
Â  Â  Â  Â  Â  Â  Â  Â  if (displayName.includes("Flute anthem")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  playSong(id, idx, displayName);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Dropping soon! ğŸš€");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  // Normal behavior for list2, list3
Â  Â  Â  Â  Â  Â  Â  Â  playSong(id, idx, displayName);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  listElem.appendChild(div);
Â  Â  });
}

function toggleList(id){
Â  Â  document.querySelectorAll('.songList').forEach(l => { if(l.id!==id) l.style.display="none"; });
Â  Â  let el = document.getElementById(id);
Â  Â  el.style.display = (el.style.display === "block") ? "none" : "block";
}

/* FIREBASE INTEGRATION LOGIC */

async function incrementViewCount(songDisplayName) {
    if (!window.db) {
        console.error("Firebase DB not initialized.");
        return;
    }

    // Use a simplified, safe key for the database
    const dbKey = songDisplayName.replace(/[.#$/[\]]/g, "_");

    try {
        const songRef = ref(window.db, 'views/' + dbKey);
        const snapshot = await get(songRef);
        let currentViews = 0;

        if (snapshot.exists()) {
            currentViews = snapshot.val().views || 0;
        }

        // Increment and update the database
        await update(songRef, { views: currentViews + 1 });
        // console.log(`View count for ${songDisplayName} incremented to ${currentViews + 1}`);

        // OPTIONAL: Refresh trending list after update
        // fetchTrendingSongs();

    } catch (error) {
        console.error("Error updating view count:", error);
    }
}

// Conceptual function to fetch and display trending data
function fetchTrendingSongs() {
    // This is where you would fetch data from Firebase DB, sort it,
    // and dynamically generate the 'trendingItem' elements.
    // For now, the trending list uses static placeholder data in the HTML.
    // The actual implementation relies on Firebase DB structure (e.g., 'views/').
    // Example:
    /*
    const viewsRef = ref(window.db, 'views');
    get(viewsRef).then((snapshot) => {
        if (snapshot.exists()) {
            const songViews = snapshot.val();
            const trending = Object.keys(songViews)
                .map(key => ({
                    name: key.replace(/_/g, " "), // reverse the safe key
                    views: songViews[key].views,
                    // You'd need a map to get the correct artist/image for the key
                }))
                .sort((a, b) => b.views - a.views)
                .slice(0, 5); // Top 5
            
            // ... then dynamically inject HTML into #trendingList
        }
    });
    */
    console.log("Trending songs feature initialized. Requires dynamic Firebase data fetching.");
}


/* PLAYER LOGIC */
let currentList = null, currentIndex = 0;
let audio = document.getElementById("audio");
let seekSlider = document.getElementById("seekSlider");
let currTimeText = document.getElementById("currTimeText");
let durTimeText = document.getElementById("durTimeText");

audio.addEventListener('ended', nextSong);

audio.addEventListener('timeupdate', () => {
Â  Â  if(audio.duration){
Â  Â  Â  Â  let pct = (audio.currentTime / audio.duration) * 100;
Â  Â  Â  Â  seekSlider.value = pct;
Â  Â  Â  Â  currTimeText.innerText = formatTime(audio.currentTime);
Â  Â  Â  Â  durTimeText.innerText = formatTime(audio.duration);
Â  Â  }
});

seekSlider.addEventListener('input', () => {
Â  Â  if(audio.duration){
Â  Â  Â  Â  let seekTime = (seekSlider.value / 100) * audio.duration;
Â  Â  Â  Â  audio.currentTime = seekTime;
Â  Â  }
});

function playSong(list, index, displayName){
Â  Â  if(!playlists[list] || playlists[list].length === 0) return;

Â  Â  currentList = list;
Â  Â  currentIndex = index;

Â  Â  let song = playlists[list][index];
Â  Â  let clean = song.replace(".mp3","");
Â  Â Â 
Â  Â  // Set display name for player (use the one passed from UI click or re-calculate)
    let finalDisplayName = displayName;
    if(!finalDisplayName) {
        finalDisplayName = clean;
        if(clean === "Harishankar ku irukka") finalDisplayName = "Harishankar ku irukka?";
        if(clean === "Bomb") finalDisplayName = "Bomb (Endhu 1cm)";
        if(clean === "Sanjai") finalDisplayName = "Sanjai's room (Endhu 1cm)";
        if(clean === "Flute anthem") finalDisplayName = "Flute anthem(LOT-III)";
        if(clean === "Jishnu anthem Thalapathy Vijay vocal") finalDisplayName = "Jishnu Anthem Thalapathy Vijay Vocal";
    }

Â  Â  let artist = getArtist(finalDisplayName) || getArtist(clean);
Â  Â  let color = getColor(finalDisplayName) || getColor(clean);

Â  Â  audio.src = song;
Â  Â  let playPromise = audio.play();

    // Increment view count on play
    incrementViewCount(finalDisplayName);

Â  Â  if (playPromise !== undefined) {
Â  Â  Â  Â  playPromise.then(_ => startVisuals()).catch(e => { console.error(e); stopVisuals(); });
Â  Â  }

Â  Â  document.getElementById("seekContainer").style.display = "flex";

Â  Â  showPopup(finalDisplayName, artist, list);
Â  Â  applySongTheme(color);
Â  Â  animatePlayButton();
}

function togglePlay(){
Â  Â  if(!audio.src) return;Â 
Â  Â  if(audio.paused){ audio.play().then(()=>startVisuals()); }
Â  Â  else { audio.pause(); stopVisuals(); }
Â  Â  animatePlayButton();
Â  Â  toggleWave();
}

function prevSong(){
Â  Â  if(!currentList || playlists[currentList].length === 0) return;
Â  Â Â 
Â  Â  // Block playback if it's the Singles list
Â  Â  if(currentList === 'list4') return;
Â  Â Â 
Â  Â  // Block playback for list1 (prevents skipping to locked songs)
Â  Â  if(currentList === 'list1') return;Â 

Â  Â  currentIndex = (currentIndex - 1 + playlists[currentList].length) % playlists[currentList].length;
    
    // Get the display name of the new song to be played
    const newSongFile = playlists[currentList][currentIndex];
    const newSongClean = newSongFile.replace(".mp3", "");
    let newDisplayName = newSongClean;
    if(newSongClean === "Harishankar ku irukka") newDisplayName = "Harishankar ku irukka?";
    if(newSongClean === "Bomb") newDisplayName = "Bomb (Endhu 1cm)";
    if(newSongClean === "Sanjai") newDisplayName = "Sanjai's room (Endhu 1cm)";
    if(newSongClean === "Flute anthem") newDisplayName = "Flute anthem(LOT-III)";
    if(newSongClean === "Jishnu anthem Thalapathy Vijay vocal") newDisplayName = "Jishnu Anthem Thalapathy Vijay Vocal";

Â  Â  playSong(currentList, currentIndex, newDisplayName);
}

function nextSong(){
Â  Â  if(!currentList || playlists[currentList].length === 0) return;
Â  Â Â 
Â  Â  // Block playback if it's the Singles list
Â  Â  if(currentList === 'list4') return;

Â  Â  // Block playback for list1 (prevents skipping to locked songs)
Â  Â  if(currentList === 'list1') return;

Â  Â  currentIndex = (currentIndex + 1) % playlists[currentList].length;

    // Get the display name of the new song to be played
    const newSongFile = playlists[currentList][currentIndex];
    const newSongClean = newSongFile.replace(".mp3", "");
    let newDisplayName = newSongClean;
    if(newSongClean === "Harishankar ku irukka") newDisplayName = "Harishankar ku irukka?";
    if(newSongClean === "Bomb") newDisplayName = "Bomb (Endhu 1cm)";
    if(newSongClean === "Sanjai") newDisplayName = "Sanjai's room (Endhu 1cm)";
    if(newSongClean === "Flute anthem") newDisplayName = "Flute anthem(LOT-III)";
    if(newSongClean === "Jishnu anthem Thalapathy Vijay vocal") newDisplayName = "Jishnu Anthem Thalapathy Vijay Vocal";

Â  Â  playSong(currentList, currentIndex, newDisplayName);
}

/* POPUP CLOSE FUNCTION */
function closePopup() {
Â  Â  document.getElementById("popup").style.display = "none";
Â  Â Â 
Â  Â  // Stop the music
Â  Â  audio.pause();
Â  Â Â 
Â  Â  // Stop visuals
Â  Â  stopVisuals();
Â  Â Â 
Â  Â  // Update play button to 'paused' state (triangle)
Â  Â  animatePlayButton();
Â  Â Â 
Â  Â  // Stop wave animation
Â  Â  toggleWave();Â 
}

/* VISUALS */
function startVisuals() { document.body.classList.add("pulsing"); }
function stopVisuals() { document.body.classList.remove("pulsing"); }

function applySongTheme(color){
Â  Â  document.documentElement.style.setProperty('--song-color', color);
Â  Â  document.body.style.background = `radial-gradient(circle at center, ${color}22 0%, #0a0f2e 100%)`;
Â  Â  document.querySelectorAll("#soundwave div").forEach(w => w.style.background = color);
Â  Â  document.querySelector(".player").style.borderColor = color;
}

function showPopup(songName, artist, list){
Â  Â  let popup = document.getElementById("popup");
Â  Â  popup.style.display = "block";
Â  Â  document.getElementById("popupSongName").innerHTML = `<span>${songName} â€” ${artist}</span>`;
Â  Â Â 
Â  Â  let img = document.getElementById("popupImg");
Â  Â  img.style.display="block";
Â  Â Â 
Â  Â  img.src = getPopupImg(list, songName);
Â  Â Â 
Â  Â  toggleWave();
}

function animatePlayButton(){
Â  Â  let icon = document.getElementById("playPauseIcon");
Â  Â  icon.innerText = audio.paused ? "â–¶" : "â¸";
Â  Â  icon.style.marginLeft = audio.paused ? "2px" : "0px";
}

function toggleWave(){
Â  Â  let wave = document.getElementById("soundwave");
Â  Â  if(audio.paused) wave.classList.add("paused");
Â  Â  else wave.classList.remove("paused");
}

function formatTime(s) {
Â  Â  if(isNaN(s)) return "0:00";
Â  Â  let min = Math.floor(s / 60);
Â  Â  let sec = Math.floor(s % 60);
Â  Â  if(sec < 10) sec = "0" + sec;
Â  Â  return min + ":" + sec;
}

// Initial call to load/simulate trending songs
document.addEventListener('DOMContentLoaded', fetchTrendingSongs);

</script>
</body>
</html>
